<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <div th:insert="fragments/common :: head('게시판')"></div>
    <!-- include summernote css/js -->
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-bs4.min.js"></script>
    <style>
        .container {
            margin-top: 50px;
        }

        h2 {
            margin-bottom: 10px;
        }

    </style>
    <script>
        function showFileName(){
            const fileInput=document.getElementById("customFile");
            var fileName = $(fileInput).val().split('\\').pop();
            $(fileInput).siblings('.custom-file-label').addClass('selected').html(fileName);
        }

        $(document).ready(function () {
            $('.summernote').summernote({
                placeholder: '내용을 입력해주세요.',
                height:500,
                //콜백 함수
                /*callbacks : {
            	    onImageUpload : function(files, editor, welEditable) {
                        // 파일 업로드(다중업로드를 위해 반복문 사용)
                        for (var i = files.length - 1; i >= 0; i--) {
                            uploadSummernoteImageFile(files[i], this);
            		    }
            	    }
                }*/
            });
            $('.note-resizebar').css('display', 'none');
        });

        /*function uploadSummernoteImageFile(file, el){       // 서버에 파일 업로드
            data=new FormData();
            data.append("file", file);
            $ajax({
                data : data,
                type : "POST",
                url : "/post/upload",
                contentType : false,
                enctype : 'multipart/form-data',
                processData : false,
                success : function(data) {
                    $(el).summernote('editor.insetImage', data.url);
                }
            });
        }*/
    </script>
</head>

<body>
<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top" th:replace="fragments/common :: menu('board')">
</nav>
<div class="container">
    <h2>✍️게시판</h2>
    <form action="#" id="save" th:action="@{/post/new}" th:object="${post}" method="post" enctype="multipart/form-data">
        <input type="hidden" th:field="*{id}">
        <div class="card mt-3 mb-3">
            <div class="card-header">
                <input type="text" class="form-control" id="title" th:field="*{title}" maxlength='30' placeholder="제목을 입력해주세요." required>
            </div>
            <textarea id="content" th:field="*{content}" class="summernote" required></textarea>
        </div>
        <div class="text-right">
            <button type="submit" class="btn btn-primary" id="write">저장</button>
        </div>
    </form>
</div>
<script>
    var checkUnload=true;
    $("#write").on("click", function() {
        checkUnload=false;
    });

    $(window).on('beforeunload', function() {
        if(checkUnload) return "이 페이지를 벗어나면 작성된 내용은 저장되지 않습니다.";
    });
</script>
</body>
</html>